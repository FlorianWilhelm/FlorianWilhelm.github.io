<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Florian Wilhelm's blog</title><link href="https://florianwilhelm.info/" rel="alternate"></link><link href="https://florianwilhelm.info/feed/atom/index.html" rel="self"></link><id>https://florianwilhelm.info/</id><updated>2023-05-13T08:00:00+02:00</updated><entry><title>WALD: A Modern &amp; Sustainable Analytics Stack</title><link href="https://florianwilhelm.info/2023/05/waldstack/" rel="alternate"></link><published>2023-05-13T08:00:00+02:00</published><updated>2023-05-13T08:00:00+02:00</updated><author><name>Florian Wilhelm</name></author><id>tag:florianwilhelm.info,2023-05-13:/2023/05/waldstack/</id><summary type="html">&lt;p&gt;The &lt;span class="caps"&gt;WALD&lt;/span&gt; Stack is composed of four powerful technologies, i.e. a modern, cloud-computing Warehouse like Snowflake,  Google BigQuery or Databricks Lakehouse, the open-source data integration engine Airbyte, the open-source full-stack &lt;span class="caps"&gt;BI&lt;/span&gt; platform Lightdash, and the open-source data transformation tool &lt;span class="caps"&gt;DBT&lt;/span&gt;.&lt;/p&gt;</summary><content type="html">&lt;p&gt;&amp;nbsp;
&lt;figure&gt;
&lt;p align="center"&gt;
&lt;img class="noZoom" src="/images/wald-definition.png" alt="Components of the WALD stack" width="600"&gt;
&lt;/p&gt;
&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;The &lt;a href="https://waldstack.org/"&gt;&lt;span class="caps"&gt;WALD&lt;/span&gt; Stack&lt;/a&gt; is a modern and sustainable analytics stack composed of four powerful technologies.
It includes a modern cloud-computing &lt;strong&gt;W&lt;/strong&gt;arehouse like &lt;a href="https://www.snowflake.com/"&gt;Snowflake&lt;/a&gt;, &lt;a href="https://cloud.google.com/bigquery"&gt;Google BigQuery&lt;/a&gt;, or &lt;a href="https://www.databricks.com/product/data-lakehouse"&gt;Databricks Lakehouse&lt;/a&gt;,
the open-source data integration engine &lt;a href="https://airbyte.com/"&gt;&lt;strong&gt;A&lt;/strong&gt;irbyte&lt;/a&gt;, the open-source full-stack &lt;span class="caps"&gt;BI&lt;/span&gt; platform &lt;a href="https://www.lightdash.com/"&gt;&lt;strong&gt;L&lt;/strong&gt;ightdash&lt;/a&gt;, and the open-source
data transformation tool &lt;a href="https://www.getdbt.com/"&gt;&lt;strong&gt;D&lt;/strong&gt;&lt;span class="caps"&gt;BT&lt;/span&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The &lt;span class="caps"&gt;WALD&lt;/span&gt; Stack is sustainable because its three major components, Airbyte, &lt;span class="caps"&gt;DBT&lt;/span&gt;, and Lightdash, are open-source and maintained by a community
of developers committed to its long-term&amp;nbsp;success.&lt;/p&gt;
&lt;p&gt;Checkout my &lt;a href="https://pretalx.com/pyconde-pydata-berlin-2023/talk/TP7ABB/"&gt;PyConDE/PyData 2023 talk&lt;/a&gt; about the &lt;a href="https://waldstack.org/"&gt;&lt;span class="caps"&gt;WALD&lt;/span&gt; Stack&lt;/a&gt; as well as the &lt;a href="https://github.com/FlorianWilhelm/wald-stack-demo/blob/main/assets/slides/inovex-wald-stack-pycon-pydata-small.pdf"&gt;slides&lt;/a&gt; if you want to learn&amp;nbsp;more.&lt;/p&gt;
&lt;p&gt;&lt;span class="videobox"&gt;
                    &lt;iframe width="800" height="500"
                        src='https://www.youtube.com/embed/7GfbA6_a09I'
                        frameborder='0' webkitAllowFullScreen
                        mozallowfullscreen allowFullScreen&gt;
                    &lt;/iframe&gt;
                &lt;/span&gt;&lt;/p&gt;</content><category term="post"></category><category term="dbt"></category><category term="Python"></category><category term="airbyte"></category><category term="Snowflake"></category><category term="lightdash"></category></entry><entry><title>The Programme of the PyConDE / PyData 2023 in Berlin</title><link href="https://florianwilhelm.info/2023/03/pyconde_pydata_2023_conference_programme_with_pretalx_and_pytanis/" rel="alternate"></link><published>2023-03-10T08:00:00+01:00</published><updated>2023-03-10T08:00:00+01:00</updated><author><name>Florian Wilhelm</name></author><id>tag:florianwilhelm.info,2023-03-10:/2023/03/pyconde_pydata_2023_conference_programme_with_pretalx_and_pytanis/</id><summary type="html">&lt;p&gt;Organising the programme of a conference is a hard nut to crack but luckily &lt;a href="https://pretalx.com/"&gt;pretalx&lt;/a&gt; is a conference management software that stays with you every step of the way. It becomes even easier if you also use &lt;a href="https://florianwilhelm.info/pytanis/"&gt;Pytanis&lt;/a&gt;, the new library for&amp;nbsp;pretalx!&lt;/p&gt;</summary><content type="html">&lt;h2&gt;Long Story&amp;nbsp;Short&lt;/h2&gt;
&lt;p&gt;For this year&amp;#8217;s &lt;a href="https://2023.pycon.de/"&gt;PyConDE &lt;span class="amp"&gt;&amp;amp;&lt;/span&gt; PyData Berlin 2023&lt;/a&gt;, I was one of the chairs in the programme committee and learnt a lot along the way
from the Call for Proposals (CfP) to the review and selection to the creation of the final program. Along the way, I implemented
a little library called &lt;a href="https://florianwilhelm.info/pytanis/"&gt;Pytanis&lt;/a&gt;, which helps to automatize common tasks. Pytanis basically allows you to interact easily
with the &lt;span class="caps"&gt;API&lt;/span&gt; of &lt;a href="https://pretalx.com/"&gt;pretalx&lt;/a&gt; to download entities like submission (proposals), reviews etc., interact with them using &lt;a href="https://pandas.pydata.org/"&gt;Pandas&lt;/a&gt;,
publish results to &lt;a href="https://www.google.com/sheets/about/"&gt;Google Sheets&lt;/a&gt; for everyone to see and comment as well as sending mails using &lt;a href="https://www.helpdesk.com/"&gt;HelpDesk&lt;/a&gt;. Everything
nicely integrated with a lot of example code in &lt;a href="https://github.com/FlorianWilhelm/pytanis/tree/main/notebooks/pyconde-pydata-berlin-2023"&gt;Jupyter notebooks&lt;/a&gt;. &lt;/p&gt;
&lt;p&gt;The &lt;a href="https://florianwilhelm.info/pytanis/"&gt;documentation of Pytanis&lt;/a&gt; explains in detail the different steps of creating a programme for a conference and I hope
that others find it helpful so that Pytanis can live on and also help with the programme of other conferences in the future.
If you are interested in the source code, it&amp;#8217;s of course open-source, &lt;span class="caps"&gt;MIT&lt;/span&gt;-licensed and available in the &lt;a href="https://github.com/FlorianWilhelm/pytanis"&gt;Github repository of Pytanis&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;So check it out! There&amp;#8217;s nothing more to see here&amp;nbsp;;-)&lt;/p&gt;</content><category term="post"></category><category term="python"></category><category term="mathematics"></category><category term="conference"></category></entry><entry><title>Forget about AI and do Mathematical Modelling instead!</title><link href="https://florianwilhelm.info/2022/10/forget_about_ai_and_do_mathematical_modelling_instead/" rel="alternate"></link><published>2022-10-16T08:00:00+02:00</published><updated>2022-10-16T08:00:00+02:00</updated><author><name>Florian Wilhelm</name></author><id>tag:florianwilhelm.info,2022-10-16:/2022/10/forget_about_ai_and_do_mathematical_modelling_instead/</id><summary type="html">&lt;p&gt;The term artificial intelligence (&lt;span class="caps"&gt;AI&lt;/span&gt;) seems to be ubiquitous these days. It seems that anything can and should be solved using &lt;span class="caps"&gt;AI&lt;/span&gt; but does it really make sense to use neural networks for every&amp;nbsp;use-case?&lt;/p&gt;</summary><content type="html">&lt;p&gt;The term artificial intelligence (&lt;span class="caps"&gt;AI&lt;/span&gt;) seems to be ubiquitous these days. It is being used or is supposed to be used, in almost all areas to automate processes, perform difficult tasks or to help us make decisions.
In my talk, which was presented at &lt;a href="https://codetalks.de/program#talk-1118?event=7"&gt;Code.Talks 2022&lt;/a&gt;, I invite you to take a look behind the hype around &lt;span class="caps"&gt;AI&lt;/span&gt;. From my practical experiences as a data scientist, I will show you that many relevant use-cases can be solved without &lt;span class="caps"&gt;AI&lt;/span&gt;,
just by applying some old-school &lt;em&gt;mathematical modelling&lt;/em&gt;. You will see the many advantages of mathematical modelling like interpretability, data-efficiency, robustness, etc. 
over &lt;span class="caps"&gt;AI&lt;/span&gt;-based approaches. The main take-away is that you should always focus on understanding the problem itself before you choose a method - be it a neural network or linear regression - to solve&amp;nbsp;it.&lt;/p&gt;
&lt;p&gt;The slides are available on &lt;a href="https://www.slideshare.net/FlorianWilhelm2/forget-about-ai-and-do-mathematical-modelling-instead"&gt;SlideShare&lt;/a&gt; and a podcast episode about the same topic is available on &lt;a href="https://digital-future.podigee.io/13-neue-episode#t=2"&gt;Digital Future&lt;/a&gt;, the &lt;a href="https://www.inovex.de/en/"&gt;inovex&lt;/a&gt; podcast, in&amp;nbsp;German.&lt;/p&gt;
&lt;p&gt;&lt;span class="videobox"&gt;
                    &lt;iframe width="800" height="500"
                        src='https://www.youtube.com/embed/S_vefzluy4o'
                        frameborder='0' webkitAllowFullScreen
                        mozallowfullscreen allowFullScreen&gt;
                    &lt;/iframe&gt;
                &lt;/span&gt;&lt;/p&gt;</content><category term="talk"></category><category term="data science"></category><category term="mathematics"></category><category term="ai"></category></entry><entry><title>Effective and Consistent Configuration via YAML &amp; CLI with Hydra</title><link href="https://florianwilhelm.info/2022/01/configuration_via_yaml_and_cli_with_hydra/" rel="alternate"></link><published>2022-01-27T10:00:00+01:00</published><updated>2022-01-27T10:00:00+01:00</updated><author><name>Florian Wilhelm</name></author><id>tag:florianwilhelm.info,2022-01-27:/2022/01/configuration_via_yaml_and_cli_with_hydra/</id><summary type="html">&lt;p&gt;Hydra allows you to have consistent configuration of Python applications via a command-line interface and &lt;span class="caps"&gt;YAML&lt;/span&gt;&amp;nbsp;files.&lt;/p&gt;</summary><content type="html">&lt;p&gt;A frequent requirement for productive Python application is that they are configurable via configuration files and/or
the command-line-interface (&lt;span class="caps"&gt;CLI&lt;/span&gt;). This allows you to change the behavior of your application without touching the source code, e.g. configuring
another database &lt;span class="caps"&gt;URL&lt;/span&gt; or the logging verbosity. For the &lt;span class="caps"&gt;CLI&lt;/span&gt;-part, &lt;a href="https://docs.python.org/3/library/argparse.html"&gt;argparse&lt;/a&gt; or &lt;a href="https://click.palletsprojects.com/"&gt;click&lt;/a&gt; is often used and with &lt;a href="https://pyyaml.org/"&gt;PyYAML&lt;/a&gt; configuration files
can be easily read, so where is the&amp;nbsp;problem?&lt;/p&gt;
&lt;p&gt;Configuration of a Python application by &lt;span class="caps"&gt;CLI&lt;/span&gt; or a &lt;span class="caps"&gt;YAML&lt;/span&gt; file have many things in common, i.e.,&amp;nbsp;both&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;configure the runtime behaviour of your&amp;nbsp;application,&lt;/li&gt;
&lt;li&gt;need to implement validations, e.g. is the port an integer above&amp;nbsp;1024,&lt;/li&gt;
&lt;li&gt;need to be consistent and mergeable, i.e. a &lt;span class="caps"&gt;CLI&lt;/span&gt; flag should be named like the &lt;span class="caps"&gt;YAML&lt;/span&gt; key and if both are passed the &lt;span class="caps"&gt;CLI&lt;/span&gt;
   overwrites the &lt;span class="caps"&gt;YAML&lt;/span&gt;&amp;nbsp;configuration.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Thus implementing configuration by a &lt;span class="caps"&gt;CLI&lt;/span&gt; and a &lt;span class="caps"&gt;YAML&lt;/span&gt; file separately, leads often to code duplication
and inconsistent behavior, not to mention the enormous amount of work that must be done to get this&amp;nbsp;right.&lt;/p&gt;
&lt;p&gt;With this in mind, Facebook implemented the &lt;a href="https://hydra.cc/"&gt;Hydra&lt;/a&gt; library, which allows you to do hierarchical configuration by
composition of config files and overrides via the command line. In this blog post, we demonstrate in an example project
the most important features of &lt;a href="https://hydra.cc/"&gt;Hydra&lt;/a&gt; and how it can be used in conjunction with &lt;a href="https://pydantic-docs.helpmanual.io/"&gt;pydantic&lt;/a&gt;,
which extends its validation capabilities. To follow along, check out  this &lt;a href="https://github.com/FlorianWilhelm/hydra-example-project"&gt;repository&lt;/a&gt; that serves as a demonstration, but also as a playground for&amp;nbsp;you.&lt;/p&gt;
&lt;h3&gt;Ok, so give me the gist of how Hydra&amp;nbsp;works&lt;/h3&gt;
&lt;p&gt;Sure, just take a look into &lt;a href="https://github.com/FlorianWilhelm/hydra-example-project/blob/master/src/my_pkg/cli.py"&gt;cli.py&lt;/a&gt; and &lt;a href="https://github.com/FlorianWilhelm/hydra-example-project/blob/master/src/my_pkg/config.py"&gt;config.py&lt;/a&gt; first as these are the only files we added,
roughly 70 lines of code. The hierarchical configuration can be found in the &lt;a href="https://github.com/FlorianWilhelm/hydra-example-project/tree/master/configs"&gt;configs&lt;/a&gt; folder and look like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;├── configs
│   ├── main.yaml             &amp;lt;- entry point for configuration
│   ├── db                    &amp;lt;- database configuration group
│   │   ├── mysql.yaml        &amp;lt;- configuration for MySQL
│   │   └── postgresql.yaml   &amp;lt;- configuration for PostgreSQL
│   └── experiment            &amp;lt;- experiment configuration group
│       ├── exp1.yaml         &amp;lt;- configuration for experiment 1
│       ├── exp2.yaml         &amp;lt;- configuration for experiment 2
│       ├── missing_key.yaml  &amp;lt;- wrong configuration with missing key
│       └── wrong_type.yaml   &amp;lt;- wrong configuration with wrong type
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Basically, this structure allows you to mix and match your configuration by choosing for instance the configuration for
the MySQL database with the configuration for experiment 2. Hydra creates for you one consistent configuration object,
some kind of nested dictionary of dictionaries, where each configuration group is an&amp;nbsp;attribute.&lt;/p&gt;
&lt;p&gt;In the &lt;a href="https://github.com/FlorianWilhelm/hydra-example-project"&gt;repository&lt;/a&gt; of our example project, we defined the &lt;span class="caps"&gt;CLI&lt;/span&gt; command &lt;code&gt;hydra-test&lt;/code&gt; by changing in &lt;code&gt;setup.cfg&lt;/code&gt; the following&amp;nbsp;lines:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Add here console scripts like:&lt;/span&gt;
&lt;span class="na"&gt;console_scripts&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="na"&gt;hydra-test&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;my_pkg.cli:main&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We can thus invoke our application with the console command &lt;code&gt;hydra-test&lt;/code&gt; and this will execute the &lt;code&gt;main&lt;/code&gt; function in &lt;code&gt;cli.py&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nd"&gt;@hydra&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;config_path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;config_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;main&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cfg&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Config&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="c1"&gt;# this line actually runs the checks of pydantic&lt;/span&gt;
    &lt;span class="n"&gt;OmegaConf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_object&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cfg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="c1"&gt;# log to console and into the `outputs` folder per default&lt;/span&gt;
    &lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;OmegaConf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_yaml&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cfg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="c1"&gt;# note that IDEs allow auto-complete for accessing the attributes!&lt;/span&gt;
    &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cfg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Looking at the actual code, we see that we only trigger some &lt;a href="https://pydantic-docs.helpmanual.io/"&gt;pydantic&lt;/a&gt; checks to see if the configuration and &lt;span class="caps"&gt;CLI&lt;/span&gt; parameters are correct,
then we log the current configuration and sleep for the time defined in the&amp;nbsp;configuration.&lt;/p&gt;
&lt;p&gt;So executing just &lt;code&gt;hydra-test&lt;/code&gt; results&amp;nbsp;in:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Cannot find primary config &amp;#39;main&amp;#39;. Check that it&amp;#39;s in your config search path.

Config search path:
    provider=hydra, path=pkg://hydra.conf
    provider=main, path=pkg://my_pkg
    provider=schema, path=structured://

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This is due to the fact that we set &lt;code&gt;config_path=None&lt;/code&gt;, which is desirable for a productive application. The application
itself doesn&amp;#8217;t know where it is going to be installed and thus defining a path to the configuration files doesn&amp;#8217;t make any sense.
For this reason we pass the configuration at execution time with &lt;code&gt;-cd&lt;/code&gt;, short form of &lt;code&gt;--config-dir&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;hydra-test&lt;span class="w"&gt; &lt;/span&gt;-cd&lt;span class="w"&gt; &lt;/span&gt;configs
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This results in the&amp;nbsp;error:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Error executing job with overrides: []
Traceback (most recent call last):
  File &amp;quot;.../hydra-example-project/src/my_pkg/cli.py&amp;quot;, line 11, in main
    OmegaConf.to_object(cfg)
omegaconf.errors.MissingMandatoryValue: Structured config of type `Config` has missing mandatory value: experiment
    full_key: experiment
    object_type=Config

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This behavior is exactly as we want it, because a look into &lt;a href="https://github.com/FlorianWilhelm/hydra-example-project/blob/master/src/my_pkg/config.py"&gt;config.py&lt;/a&gt; shows us that the schema of the main configuration&amp;nbsp;is:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nd"&gt;@dataclass&lt;/span&gt;
&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Config&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Main&lt;/span&gt;
    &lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;DataBase&lt;/span&gt;
    &lt;span class="n"&gt;neptune&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Neptune&lt;/span&gt;
    &lt;span class="n"&gt;experiment&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Experiment&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MISSING&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;and the experiment is defined as &lt;code&gt;MISSING&lt;/code&gt;. Therefore, experiment is a mandatory parameter that the user needs to provide via the &lt;span class="caps"&gt;CLI&lt;/span&gt;. 
Consequently, we add &lt;code&gt;+experiment=exp1&lt;/code&gt; to select the configuration from &lt;code&gt;exp1.yaml&lt;/code&gt; and finally get what we would&amp;nbsp;expect:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;❯ hydra-test -cd configs +experiment=exp1
[2022-01-27 08:14:34,257][my_pkg.cli][INFO] -
main:
  sleep: 3
neptune:
  project: florian.wilhelm/my_expriments
  api_token: ~/.neptune_api_token
  tags:
  - run-1
  description: Experiment run on GCP
  mode: async
db:
  driver: mysql
  host: server_string
  port: ${oc.env:MYSQL_PORT,1028}
  username: myself
  password: secret
experiment:
  model: XGBoost
  l2: 0.01
  n_steps: 1000
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Note the plus sign in the flag &lt;code&gt;+experiment&lt;/code&gt;. This is needed since we &lt;em&gt;add&lt;/em&gt; the mandatory experiment parameter. Conveniently, 
Hydra has also set up the logging for us and besides logging to the terminal, all output will also be collected in the &lt;code&gt;./outputs&lt;/code&gt;
folder.&lt;/p&gt;
&lt;p&gt;So the section &lt;code&gt;main&lt;/code&gt; and &lt;code&gt;neptune&lt;/code&gt; are directly defined in &lt;code&gt;main.yaml&lt;/code&gt;, but why did Hydra now choose the MySQL database?
This is due to fact that in &lt;code&gt;main.yaml&lt;/code&gt;, we defined some&amp;nbsp;defaults:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# hydra section to build up the config hierarchy with defaults&lt;/span&gt;
&lt;span class="nt"&gt;defaults&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;_self_&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;base_config&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;db&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;mysql.yaml&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;# experiment: is not mentioned here but in config.py to have a mandatory setting&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Taking a look into &lt;a href="https://github.com/FlorianWilhelm/hydra-example-project/blob/master/configs/db/mysql.yaml"&gt;mysql.yaml&lt;/a&gt;, we see that Hydra also allows accessing environment variables easily to help with 
configuration. As an example, we defined the database port to be whatever the environment variable &lt;code&gt;MYSQL_PORT&lt;/code&gt; is set
to or 1028 if undefined. So Hydra does not only unify the configuration via &lt;span class="caps"&gt;YAML&lt;/span&gt; and &lt;span class="caps"&gt;CLI&lt;/span&gt; but also via environment&amp;nbsp;variables.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;driver&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;mysql&lt;/span&gt;
&lt;span class="nt"&gt;host&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;server_string&lt;/span&gt;
&lt;span class="nt"&gt;port&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;${oc.env:MYSQL_PORT,1028}&lt;/span&gt;
&lt;span class="nt"&gt;username&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;myself&lt;/span&gt;
&lt;span class="nt"&gt;password&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;secret&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We can also override the default database by adding the flag &lt;code&gt;db=postgresql&lt;/code&gt;. This time the flag has no &lt;code&gt;+&lt;/code&gt; as we override a&amp;nbsp;default:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;❯ hydra-test -cd configs +experiment=exp1 db=postgresql
Error executing job with overrides: [&amp;#39;+experiment=exp1&amp;#39;, &amp;#39;db=postgresql&amp;#39;]
Traceback (most recent call last):
  File &amp;quot;.../hydra-example-project/src/my_pkg/cli.py&amp;quot;, line 11, in main
    OmegaConf.to_object(cfg)
pydantic.error_wrappers.ValidationError: 1 validation error for DataBase
port
  Choose a non-privileged port! (type=value_error)

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Nice! This works just as expected by telling us that our port configuration is actually wrong as we chose a privileged port!
This is the magic of &lt;a href="https://pydantic-docs.helpmanual.io/"&gt;pydantic&lt;/a&gt; doing its validation work. Taking a look into &lt;code&gt;config.py&lt;/code&gt;, we see the check that assures
a port not smaller than&amp;nbsp;1024.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nd"&gt;@dataclass&lt;/span&gt;
&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DataBase&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;
    &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;
    &lt;span class="nd"&gt;@validator&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;port&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;check_non_privileged_port&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;cls&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="ne"&gt;ValueError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Choose a non-privileged port!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;
    &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;
    &lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;
    &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Good, we can now fix our configuration file or just pass an extra parameter if we are in a hurry,&amp;nbsp;i.e.:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;❯ hydra-test -cd configs +experiment=exp1 db=postgresql db.port=1832
[2022-01-27 08:13:52,148][my_pkg.cli][INFO] -
main:
  sleep: 3
neptune:
  project: florian.wilhelm/my_expriments
  api_token: ~/.neptune_api_token
  tags:
  - run-1
  description: Experiment run on GCP
  mode: async
db:
  driver: postgreqsql
  host: server_string
  port: 1832
  username: me
  password: birthday
experiment:
  model: XGBoost
  l2: 0.01
  n_steps: 1000
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And this works! So much flexibility and robustness in just 70 lines of code, awesome! While you are at it, you can also
run &lt;code&gt;hydra-test -cd configs +experiment=missing_key&lt;/code&gt; and &lt;code&gt;hydra-test -cd configs +experiment=wrong_type&lt;/code&gt; to see some
nice errors from pydantic telling you about a missing key and a wrong type of the configuration value, respectively.
By the way, also passing the port parameter wrong, e.g. with &lt;code&gt;db.port=72&lt;/code&gt;, would have triggered the same exception, so 
the configuration via the &lt;span class="caps"&gt;CLI&lt;/span&gt; and &lt;span class="caps"&gt;YAML&lt;/span&gt; share the same checks and validations. &lt;a href="https://hydra.cc/"&gt;Hydra&lt;/a&gt; and &lt;a href="https://pydantic-docs.helpmanual.io/"&gt;pydantic&lt;/a&gt; work nicely together 
to make this possible and &lt;a href="https://pydantic-docs.helpmanual.io/"&gt;pydantic&lt;/a&gt; greatly extends the validation capabilities of &lt;a href="https://omegaconf.readthedocs.io/"&gt;OmegaConf&lt;/a&gt;, which Hydra uses
as default. Just remember to use the &lt;code&gt;dataclass&lt;/code&gt; from &lt;a href="https://pydantic-docs.helpmanual.io/"&gt;pydantic&lt;/a&gt;, not the standard library
and call &lt;code&gt;OmegaConf.to_object(cfg)&lt;/code&gt; at the start of your application to fail as early as&amp;nbsp;possible.&lt;/p&gt;
&lt;p&gt;Hydra has many more, really nice features. Imagine you want to run now the experiments &lt;code&gt;exp1&lt;/code&gt; and &lt;code&gt;exp2&lt;/code&gt; consecutively,
you can just use the &lt;code&gt;--multirun&lt;/code&gt; feature, or &lt;code&gt;-m&lt;/code&gt; for&amp;nbsp;short:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;hydra-test&lt;span class="w"&gt; &lt;/span&gt;-m&lt;span class="w"&gt; &lt;/span&gt;-cd&lt;span class="w"&gt; &lt;/span&gt;configs&lt;span class="w"&gt; &lt;/span&gt;+experiment&lt;span class="o"&gt;=&lt;/span&gt;exp1,exp2
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Or in case you have hundreds of experiments, you can also use globbing&amp;nbsp;like:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;hydra-test&lt;span class="w"&gt; &lt;/span&gt;-m&lt;span class="w"&gt; &lt;/span&gt;-cd&lt;span class="w"&gt; &lt;/span&gt;configs&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;+experiment=glob(exp*)&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;There&amp;#8217;s so much more to Hydra and several plugins even for hyperparameter optimization exist. Also note that with the
flag &lt;code&gt;--hydra-help&lt;/code&gt;, you can see the hydra-specific parameters of your application. Using just &lt;code&gt;--help&lt;/code&gt; returns some
automatic generated help according to the configuration of your application. This can of course be customized easily with
the help of a powerful templating system as described in &lt;a href="https://hydra.cc/docs/1.0/configure_hydra/app_help/"&gt;Customizing Application&amp;#8217;s help docs&lt;/a&gt;. &lt;/p&gt;
&lt;p&gt;Hydra makes configuration by &lt;span class="caps"&gt;CLI&lt;/span&gt;, &lt;span class="caps"&gt;YAML&lt;/span&gt; and environment variables a bliss and the time for learning Hydra is well invested
as your application&amp;#8217;s codebase will be more flexible configurable, less complex and therefore more&amp;nbsp;robust.&lt;/p&gt;</content><category term="post"></category><category term="python"></category><category term="configuration"></category><category term="production"></category></entry><entry><title>Matrix Factorization for Collaborative Filtering Is Just Solving an Adjoint Latent Dirichlet Allocation Model After All</title><link href="https://florianwilhelm.info/2021/09/mf_for_collaborative_filtering_is_just_solving_an_adjoint_lda_model/" rel="alternate"></link><published>2021-09-24T17:00:00+02:00</published><updated>2021-09-24T17:00:00+02:00</updated><author><name>Florian Wilhelm</name></author><id>tag:florianwilhelm.info,2021-09-24:/2021/09/mf_for_collaborative_filtering_is_just_solving_an_adjoint_lda_model/</id><summary type="html">&lt;p&gt;&lt;a href="https://en.wikipedia.org/wiki/Matrix_factorization_(recommender_systems)"&gt;Matrix factorization-based methods&lt;/a&gt; are among the most popular methods for collaborative filtering tasks with &lt;a href="https://en.wikipedia.org/wiki/Relevance_feedback"&gt;implicit feedback&lt;/a&gt;. 
The most effective of these methods do not apply sign constraints, such as non-negativity, to their factors. 
Despite their simplicity, the latent factors for users and items lack interpretability, which is becoming an increasingly …&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a href="https://en.wikipedia.org/wiki/Matrix_factorization_(recommender_systems)"&gt;Matrix factorization-based methods&lt;/a&gt; are among the most popular methods for collaborative filtering tasks with &lt;a href="https://en.wikipedia.org/wiki/Relevance_feedback"&gt;implicit feedback&lt;/a&gt;. 
The most effective of these methods do not apply sign constraints, such as non-negativity, to their factors. 
Despite their simplicity, the latent factors for users and items lack interpretability, which is becoming an increasingly important requirement. 
In this work, we provide a theoretical link between unconstrained and the interpretable &lt;a href="https://en.wikipedia.org/wiki/Non-negative_matrix_factorization"&gt;non-negative matrix factorization&lt;/a&gt; in terms of the personalized ranking induced by these methods. 
We also introduce a novel, &lt;a href="https://en.wikipedia.org/wiki/Latent_Dirichlet_allocation"&gt;latent Dirichlet allocation&lt;/a&gt;-inspired model for recommenders and extend our theoretical link to 
also allow the interpretation of an unconstrained matrix factorization as an adjoint formulation of our new model. 
Our experiments indicate that this novel approach represents the unknown processes of implicit user-item interactions in 
the real world much better than unconstrained matrix factorization while being&amp;nbsp;interpretable.&lt;/p&gt;
&lt;p&gt;This paper was presented at the 15th &lt;span class="caps"&gt;ACM&lt;/span&gt; Conference on Recommender Systems (&lt;a href="https://recsys.acm.org/recsys21/"&gt;RecSys 2021&lt;/a&gt;) in Amsterdam. 
A &lt;a href="https://dl.acm.org/doi/fullHtml/10.1145/3460231.3474266#"&gt;pre-recorded video of my presentation&lt;/a&gt; is generously provided by &lt;span class="caps"&gt;ACM&lt;/span&gt; and also the &lt;a href="https://www.slideshare.net/FlorianWilhelm2/matrix-factorization-for-collaborative-filtering-is-just-solving-an-adjoint-latent-dirichlet-allocation-model-after-all"&gt;slides&lt;/a&gt; are available. 
The recording of the presentation at RecSys22 is available&amp;nbsp;here:&lt;/p&gt;
&lt;p&gt;&lt;span class="videobox"&gt;
                    &lt;iframe width="800" height="500"
                        src='https://www.youtube.com/embed/b0HKLfKKDpo'
                        frameborder='0' webkitAllowFullScreen
                        mozallowfullscreen allowFullScreen&gt;
                    &lt;/iframe&gt;
                &lt;/span&gt;&lt;/p&gt;</content><category term="talk"></category><category term="data science"></category><category term="recommender systems"></category></entry></feed>